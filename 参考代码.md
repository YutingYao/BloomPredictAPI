```python
import pandas as pd
import numpy as np
import torch
import torch.nn as nn
from torch.utils.data import DataLoader, TensorDataset
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error, mean_absolute_error
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm
import logging
from torch.optim.lr_scheduler import OneCycleLR
import pickle
import xgboost as xgb
# 设置字体
plt.rcParams['font.family'] = ['sans-serif']
plt.rcParams['font.sans-serif'] = ['SimSun', 'DejaVu Sans']
plt.rcParams['font.serif'] = ['Times New Roman']
plt.rcParams['axes.unicode_minus'] = False
chinese_font = fm.FontProperties(fname=r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\SIMSUN.TTC', size=14)
english_font = fm.FontProperties(fname=r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\TIMES.TTF', size=14)

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

# 按照新分类重新排序的地点
location_order = ['胥湖心', '锡东水厂', '平台山', 'tuoshan', 'lanshanzui', '五里湖心']

# 重新分类的生态区域和对应的颜色 - 配色不要变
zone_info = {
    '胥湖心': {'zone_cn': '重污染与高风险区', 'zone_en': 'Heavily Polluted & High-Risk Area', 'color_primary': '#1B365D', 'color_secondary': '#B0C4DE'},  # 深海军蓝与浅蓝灰
    '锡东水厂': {'zone_cn': '重污染与高风险区', 'zone_en': 'Heavily Polluted & High-Risk Area', 'color_primary': '#1B365D', 'color_secondary': '#B0C4DE'},
    '平台山': {'zone_cn': '背景与参照区', 'zone_en': 'Background & Reference Area', 'color_primary': '#2D5016', 'color_secondary': '#9ACD32'},  # 深森林绿与浅橄榄绿
    'tuoshan': {'zone_cn': '背景与参照区', 'zone_en': 'Background & Reference Area', 'color_primary': '#2D5016', 'color_secondary': '#9ACD32'},
    'lanshanzui': {'zone_cn': '边界条件区', 'zone_en': 'Boundary Condition Area', 'color_primary': '#8B4513', 'color_secondary': '#F0E68C'},  # 深赭石色与浅卡其色
    '五里湖心': {'zone_cn': '边界条件区', 'zone_en': 'Boundary Condition Area', 'color_primary': '#8B4513', 'color_secondary': '#F0E68C'}
}

# 站点文件映射
station_files_map = {
    '胥湖心': r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\002-气象-胥湖心-merged_with_weather_with_composite_features.csv',
    '锡东水厂': r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\002-气象-锡东水厂-merged_with_weather_with_composite_features.csv',
    '平台山': r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\002-气象-平台山-merged_with_weather_with_composite_features.csv',
    'tuoshan': r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\002-气象-tuoshan-merged_with_weather_with_composite_features.csv',
    'lanshanzui': r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\002-气象-lanshanzui-merged_with_weather_with_composite_features.csv',
    '五里湖心': r'C:\Users\chinayaoyuting\OneDrive\★蓝藻\AlgaeBloomForecast-20241122\data\002-气象-五里湖心-merged_with_weather_with_composite_features.csv'
}

# 英文站点名转中文字典
station_name_map = {
    'lanshanzui': '兰山嘴',
    'tuoshan': '拖山'
}

# 英文站点名称映射
station_name_en_map = {
    '胥湖心': 'Xuhu Center', 
    '锡东水厂': 'Xidong Water Plant', 
    '平台山': 'Pingtai Mountain',
    'tuoshan': 'Tuoshan Mountain', 
    'lanshanzui': 'Lanshan Cape', 
    '五里湖心': 'Wulihu Center'
}

# 定义中英文变量名称
variables = {
    'density': {'cn': '藻密度', 'en': 'Algae Density'}, 
    'chla': {'cn': '叶绿素a', 'en': 'Chlorophyll a'}
}

# 使用基础指标来进行预测和建模计算，建简化的LaTeX表示如下
basic_indicator_formulas = {
    'temperature': r'$T$',
    'oxygen': r'$O_2$',
    'TN': r'$N_t$',
    'TP': r'$P_t$',
    'NH': r'$N_{NH}$',
    'pH': r'$pH$',
    'turbidity': r'$\tau$',
    'conductivity': r'$\sigma$',
    'permanganate': r'$COD_{Mn}$',
    'rain_sum': r'$R$',
    'wind_speed_10m_max': r'$u$',
    'shortwave_radiation_sum': r'$I_s$'
}

# 定义LSTM模型类

class LSTMModel(nn.Module):
    def __init__(self, input_size, hidden_size, num_layers, output_size, dropout=0.2):
        super(LSTMModel, self).__init__()
        self.lstm = nn.LSTM(input_size, hidden_size, num_layers, 
                           batch_first=True, dropout=dropout)
        self.fc = nn.Linear(hidden_size, output_size)
        
    def forward(self, x):
        lstm_out, _ = self.lstm(x)
        out = self.fc(lstm_out[:, -1, :])
        return out

# 定义GRU_D模型类，确保与保存模型时使用的类定义一致
class GRU_D(nn.Module):
    def __init__(self, input_size, hidden_size, num_layers, output_size, dropout=0.2):
        super(GRU_D, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        self.gru = nn.GRU(input_size, hidden_size, num_layers, batch_first=True, dropout=dropout)
        self.fc = nn.Linear(hidden_size, output_size)
        
    def forward(self, x):
        h0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)
        out, _ = self.gru(x, h0)
        out = self.fc(out[:, -1, :])
        return out

class GRUDModel(nn.Module):
    def __init__(self, input_size, hidden_size, num_layers, output_size, dropout=0.2):
        super(GRUDModel, self).__init__()
        self.grud = GRU_D(input_size, hidden_size, num_layers, output_size, dropout)
        
    def forward(self, x):
        return self.grud(x)

class Chomp1d(nn.Module):
    def __init__(self, chomp_size):
        super(Chomp1d, self).__init__()
        self.chomp_size = chomp_size

    def forward(self, x):
        return x[:, :, :-self.chomp_size].contiguous()

class TemporalBlock(nn.Module):
    def __init__(self, n_inputs, n_outputs, kernel_size, stride, dilation, padding, dropout=0.2):
        super(TemporalBlock, self).__init__()
        self.conv1 = nn.Conv1d(n_inputs, n_outputs, kernel_size,
                              stride=stride, padding=padding, dilation=dilation)
        self.chomp1 = Chomp1d(padding)
        self.relu1 = nn.ReLU()
        self.dropout1 = nn.Dropout(dropout)

        self.conv2 = nn.Conv1d(n_outputs, n_outputs, kernel_size,
                              stride=stride, padding=padding, dilation=dilation)
        self.chomp2 = Chomp1d(padding)
        self.relu2 = nn.ReLU()
        self.dropout2 = nn.Dropout(dropout)

        self.net = nn.Sequential(self.conv1, self.chomp1, self.relu1, self.dropout1,
                               self.conv2, self.chomp2, self.relu2, self.dropout2)
        self.downsample = nn.Conv1d(n_inputs, n_outputs, 1) if n_inputs != n_outputs else None
        self.relu = nn.ReLU()

    def forward(self, x):
        out = self.net(x)
        res = x if self.downsample is None else self.downsample(x)
        return self.relu(out + res)

class TCNModel(nn.Module):
    def __init__(self, input_size, output_size, num_channels, kernel_size=2, dropout=0.2):
        super(TCNModel, self).__init__()
        layers = []
        num_levels = len(num_channels)
        for i in range(num_levels):
            dilation_size = 2 ** i
            in_channels = input_size if i == 0 else num_channels[i-1]
            out_channels = num_channels[i]
            layers += [TemporalBlock(in_channels, out_channels, kernel_size,
                                   stride=1, dilation=dilation_size,
                                   padding=(kernel_size-1) * dilation_size,
                                   dropout=dropout)]

        self.network = nn.Sequential(*layers)
        self.linear = nn.Linear(num_channels[-1], output_size)

    def forward(self, x):
        x = x.transpose(1, 2)
        x = self.network(x)
        x = x[:, :, -1]
        return self.linear(x)

class XGBoostModel:
    def __init__(self):
        self.models = {}
        self.scalers = {}
        
    def create_features(self, data, seq_length, target_index):
        """将时序数据转换为XGBoost可用的特征"""
        features = []
        targets = []
        
        for i in range(seq_length, len(data)):
            # 展平时间窗口特征
            window_features = data[i-seq_length:i].flatten()
            # 添加统计特征
            window_stats = [
                np.mean(data[i-seq_length:i], axis=0),
                np.std(data[i-seq_length:i], axis=0),
                np.max(data[i-seq_length:i], axis=0),
                np.min(data[i-seq_length:i], axis=0)
            ]
            combined_features = np.concatenate([window_features] + window_stats)
            features.append(combined_features)
            targets.append(data[i, target_index])
            
        return np.array(features), np.array(targets)
    
    def train_for_days(self, train_data, seq_length, target_index):
        """为指定天数训练XGBoost模型"""
        model = xgb.XGBRegressor(
            n_estimators=500,
            max_depth=6,
            learning_rate=0.1,
            random_state=42
        )
        
        X_train, y_train = self.create_features(train_data, seq_length, target_index)
        model.fit(X_train, y_train)
        
        return model

def create_sequence_for_date(data, date_index, seq_length):
    """为指定日期创建输入序列"""
    if date_index < seq_length:
        return None
    return data[date_index - seq_length:date_index]

# 基础特征 - 使用基础指标
base_features = ['temperature', 'pH', 'oxygen', 'permanganate', 'TN', 'conductivity', 
                'turbidity', 'density', 'rain_sum', 'wind_speed_10m_max', 
                'shortwave_radiation_sum']
# LSTM、GRU-D、TCN和XGBoost模型比较
print("开始比较LSTM、GRU-D、TCN和XGBoost模型的预测性能...")

# 存储对比结果
model_comparison_results = {}

for station_name in location_order:
    print(f"\n正在比较站点: {station_name}的LSTM、GRU-D、TCN和XGBoost模型性能")
    
    # 加载LSTM、GRU-D、TCN和XGBoost模型数据
    lstm_filename = f'00-LSTM_model_data_{station_name}-去除负数.pkl'
    grud_filename = f'00-GRUD_model_data_{station_name}-去除负数.pkl'
    tcn_filename = f'00-TCN_model_data_{station_name}-去除负数.pkl'
    xgb_filename = f'00-XGB_model_data_{station_name}-去除负数.pkl'
    
    model_comparison_results[station_name] = {}
    
    try:
        # 加载LSTM模型数据
        with open(lstm_filename, 'rb') as f:
            lstm_model_data = pickle.load(f)
        
        lstm_predictions = lstm_model_data['predictions_all']
        lstm_actuals = lstm_model_data['actual_values_all']
        
        # 加载GRU-D模型数据
        with open(grud_filename, 'rb') as f:
            grud_model_data = pickle.load(f)
        
        grud_predictions = grud_model_data['predictions_all']
        grud_actuals = grud_model_data['actual_values_all']
        
        # 加载TCN模型数据
        with open(tcn_filename, 'rb') as f:
            tcn_model_data = pickle.load(f)
        
        tcn_predictions = tcn_model_data['predictions_all']
        tcn_actuals = tcn_model_data['actual_values_all']
        
        # 加载XGBoost模型数据
        with open(xgb_filename, 'rb') as f:
            xgb_model_data = pickle.load(f)
        
        xgb_predictions = xgb_model_data['predictions_all']
        xgb_actuals = xgb_model_data['actual_values_all']
        
        # 获取站点颜色
        current_zone_info = zone_info[station_name]
        primary_color = current_zone_info['color_primary']
        secondary_color = current_zone_info['color_secondary']
        
        # 比较每个预测天数的性能
        print(f"\n{station_name}站点 - LSTM vs GRU-D vs TCN vs XGBoost RMSE对比:")
        
        for days in range(1, 31):
            if (days in lstm_predictions and days in lstm_actuals and 
                days in grud_predictions and days in grud_actuals and
                days in tcn_predictions and days in tcn_actuals and
                days in xgb_predictions and days in xgb_actuals):
                
                # 计算LSTM RMSE
                lstm_rmse = np.sqrt(mean_squared_error(lstm_actuals[days], lstm_predictions[days]))
                # 计算GRU-D RMSE
                grud_rmse = np.sqrt(mean_squared_error(grud_actuals[days], grud_predictions[days]))
                # 计算TCN RMSE
                tcn_rmse = np.sqrt(mean_squared_error(tcn_actuals[days], tcn_predictions[days]))
                # 计算XGBoost RMSE
                xgb_rmse = np.sqrt(mean_squared_error(xgb_actuals[days], xgb_predictions[days]))
                
                # 计算GRU-D相对LSTM的改善率
                grud_improvement = (lstm_rmse - grud_rmse) / lstm_rmse * 100
                # 计算TCN相对LSTM的改善率
                tcn_improvement = (lstm_rmse - tcn_rmse) / lstm_rmse * 100
                # 计算XGBoost相对LSTM的改善率
                xgb_improvement = (lstm_rmse - xgb_rmse) / lstm_rmse * 100
                
                model_comparison_results[station_name][days] = {
                    'lstm_rmse': lstm_rmse,
                    'grud_rmse': grud_rmse,
                    'tcn_rmse': tcn_rmse,
                    'xgb_rmse': xgb_rmse,
                    'grud_improvement': grud_improvement,
                    'tcn_improvement': tcn_improvement,
                    'xgb_improvement': xgb_improvement
                }
                
                print(f"T+{days}天 - LSTM RMSE: {lstm_rmse:.4f}, GRU-D RMSE: {grud_rmse:.4f}, "
                      f"TCN RMSE: {tcn_rmse:.4f}, XGBoost RMSE: {xgb_rmse:.4f}, "
                      f"GRU-D改善率: {grud_improvement:.2f}%, TCN改善率: {tcn_improvement:.2f}%, "
                      f"XGBoost改善率: {xgb_improvement:.2f}%")
        
        # 绘制对比图表
        # 每6天绘制一张对比图，共5张图
        for group in range(5):  # 0-4共5组
            plt.figure(figsize=(15, 10))
            
            for i in range(6):  # 每组6天
                days = group * 6 + i + 1
                if days <= 30:  # 确保不超过30天
                    plt.subplot(3, 2, i+1)
                    
                    # 获取该预测天数的数据
                    if (days in lstm_predictions and days in lstm_actuals and 
                        days in grud_predictions and days in grud_actuals and
                        days in tcn_predictions and days in tcn_actuals and
                        days in xgb_predictions and days in xgb_actuals):
                        
                        lstm_pred = lstm_predictions[days]
                        lstm_actual = lstm_actuals[days]
                        grud_pred = grud_predictions[days]
                        grud_actual = grud_actuals[days]
                        tcn_pred = tcn_predictions[days]
                        tcn_actual = tcn_actuals[days]
                        xgb_pred = xgb_predictions[days]
                        xgb_actual = xgb_actuals[days]
                        
                        # 创建日期索引（基于测试集长度）
                        test_start_date = '2023-11-01'
                        test_end_date = '2024-05-31'
                        prediction_dates = pd.date_range(start=test_start_date, end=test_end_date)
                        
                        # 确保数据长度匹配
                        min_length = min(len(lstm_pred), len(lstm_actual), len(grud_pred), 
                                       len(grud_actual), len(tcn_pred), len(tcn_actual),
                                       len(xgb_pred), len(xgb_actual), len(prediction_dates))
                        lstm_pred = lstm_pred[:min_length]
                        lstm_actual = lstm_actual[:min_length]
                        grud_pred = grud_pred[:min_length]
                        grud_actual = grud_actual[:min_length]
                        tcn_pred = tcn_pred[:min_length]
                        tcn_actual = tcn_actual[:min_length]
                        xgb_pred = xgb_pred[:min_length]
                        xgb_actual = xgb_actual[:min_length]
                        prediction_dates = prediction_dates[:min_length]
                        
                        # 只绘制2024年1-5月的数据
                        mask = (prediction_dates >= '2024-01-01') & (prediction_dates <= '2024-05-31')
                        
                        if len(mask) == len(lstm_pred):
                            # 应用掩码筛选数据
                            filtered_dates = prediction_dates[mask]
                            filtered_lstm_pred = lstm_pred[mask]
                            filtered_grud_pred = grud_pred[mask]
                            filtered_tcn_pred = tcn_pred[mask]
                            filtered_xgb_pred = xgb_pred[mask]
                            filtered_actual = lstm_actual[mask]  # 实际值应该相同
                            
                            plt.plot(filtered_dates, filtered_lstm_pred, 
                                    label='LSTM预测', alpha=0.7, color='#1B365D', linestyle='--')
                            plt.plot(filtered_dates, filtered_grud_pred, 
                                    label='GRU-D预测', alpha=0.7, color='#8B4513', linestyle='-')
                            plt.plot(filtered_dates, filtered_tcn_pred, 
                                    label='TCN预测', alpha=0.7, color='#6A5ACD', linestyle=':')
                            plt.plot(filtered_dates, filtered_xgb_pred, 
                                    label='XGBoost预测', alpha=0.7, color='#FF4500', linestyle='-.')
                            plt.plot(filtered_dates, filtered_actual, 
                                    label='实际值', alpha=0.7, color='#2D5016', linewidth=2)
                            
                            plt.title(f'{station_name} - T+{days}天增长率预测对比', 
                                     fontproperties=chinese_font, fontsize=12)
                            plt.xlabel('日期', fontproperties=chinese_font, fontsize=10)
                            plt.ylabel('增长率', fontproperties=chinese_font, fontsize=10)
                            plt.legend(prop=chinese_font, fontsize=8)
                            plt.grid(True, alpha=0.3)
                            plt.xticks(rotation=45)
                            
                            # 设置刻度字体为英文字体
                            ax = plt.gca()
                            for label in ax.get_xticklabels() + ax.get_yticklabels():
                                label.set_fontproperties(english_font)
                        else:
                            plt.text(0.5, 0.5, f'数据长度不匹配', 
                                   ha='center', va='center', transform=plt.gca().transAxes,
                                   fontproperties=chinese_font)
            
            plt.suptitle(f'{station_name}站点 - LSTM vs GRU-D vs TCN vs XGBoost模型对比 - 第{group+1}组: T+{group*6+1}天至T+{min((group+1)*6, 30)}天', 
                         fontproperties=chinese_font, fontsize=14)
            plt.tight_layout()
            plt.show()

    except FileNotFoundError as e:
        print(f"错误: 未找到站点 {station_name} 的模型数据文件，跳过此站点。错误信息: {e}")
        continue
    except KeyError as e:
        print(f"错误: 文件中缺少必要的键 '{e}'，跳过此站点。")
        continue

# 生成总体对比报告
print("\n\n=== LSTM vs GRU-D vs TCN vs XGBoost 总体性能对比报告 ===")

for station_name in location_order:
    if station_name in model_comparison_results and model_comparison_results[station_name]:
        print(f"\n{station_name}站点:")
        
        # 计算平均改善率
        grud_improvements = [data['grud_improvement'] for data in model_comparison_results[station_name].values()]
        tcn_improvements = [data['tcn_improvement'] for data in model_comparison_results[station_name].values()]
        xgb_improvements = [data['xgb_improvement'] for data in model_comparison_results[station_name].values()]
        avg_grud_improvement = np.mean(grud_improvements)
        avg_tcn_improvement = np.mean(tcn_improvements)
        avg_xgb_improvement = np.mean(xgb_improvements)
        
        # 统计GRU-D、TCN和XGBoost优于LSTM的天数
        grud_improved_days = sum(1 for imp in grud_improvements if imp > 0)
        tcn_improved_days = sum(1 for imp in tcn_improvements if imp > 0)
        xgb_improved_days = sum(1 for imp in xgb_improvements if imp > 0)
        total_days = len(grud_improvements)
        
        print(f"GRU-D相对LSTM平均改善率: {avg_grud_improvement:.2f}%")
        print(f"TCN相对LSTM平均改善率: {avg_tcn_improvement:.2f}%")
        print(f"XGBoost相对LSTM平均改善率: {avg_xgb_improvement:.2f}%")
        print(f"GRU-D优于LSTM的天数: {grud_improved_days}/{total_days} ({grud_improved_days/total_days*100:.1f}%)")
        print(f"TCN优于LSTM的天数: {tcn_improved_days}/{total_days} ({tcn_improved_days/total_days*100:.1f}%)")
        print(f"XGBoost优于LSTM的天数: {xgb_improved_days}/{total_days} ({xgb_improved_days/total_days*100:.1f}%)")
        
        # 找出GRU-D改善最大和最小的天数
        grud_best_day = max(model_comparison_results[station_name].keys(), 
                          key=lambda k: model_comparison_results[station_name][k]['grud_improvement'])
        grud_worst_day = min(model_comparison_results[station_name].keys(), 
                           key=lambda k: model_comparison_results[station_name][k]['grud_improvement'])
        
        # 找出TCN改善最大和最小的天数
        tcn_best_day = max(model_comparison_results[station_name].keys(), 
                         key=lambda k: model_comparison_results[station_name][k]['tcn_improvement'])
        tcn_worst_day = min(model_comparison_results[station_name].keys(), 
                          key=lambda k: model_comparison_results[station_name][k]['tcn_improvement'])
        
        # 找出XGBoost改善最大和最小的天数
        xgb_best_day = max(model_comparison_results[station_name].keys(), 
                         key=lambda k: model_comparison_results[station_name][k]['xgb_improvement'])
        xgb_worst_day = min(model_comparison_results[station_name].keys(), 
                          key=lambda k: model_comparison_results[station_name][k]['xgb_improvement'])
        
        print(f"GRU-D最大改善: T+{grud_best_day}天 ({model_comparison_results[station_name][grud_best_day]['grud_improvement']:.2f}%)")
        print(f"GRU-D最小改善: T+{grud_worst_day}天 ({model_comparison_results[station_name][grud_worst_day]['grud_improvement']:.2f}%)")
        print(f"TCN最大改善: T+{tcn_best_day}天 ({model_comparison_results[station_name][tcn_best_day]['tcn_improvement']:.2f}%)")
        print(f"TCN最小改善: T+{tcn_worst_day}天 ({model_comparison_results[station_name][tcn_worst_day]['tcn_improvement']:.2f}%)")

# 绘制整体改善率对比图
plt.figure(figsize=(15, 10))

days_range = range(1, 31)
for station_name in location_order:
    if station_name in model_comparison_results and model_comparison_results[station_name]:
        grud_improvements = [model_comparison_results[station_name].get(day, {'grud_improvement': 0})['grud_improvement'] 
                           for day in days_range]
        tcn_improvements = [model_comparison_results[station_name].get(day, {'tcn_improvement': 0})['tcn_improvement'] 
                          for day in days_range]
        
        # 获取站点颜色
        current_zone_info = zone_info[station_name]
        primary_color = current_zone_info['color_primary']
        secondary_color = current_zone_info['color_secondary']
        
        plt.plot(days_range, grud_improvements, 
                label=f'{station_name} GRU-D', color=primary_color, marker='o', markersize=4, linestyle='-')
        plt.plot(days_range, tcn_improvements, 
                label=f'{station_name} TCN', color=primary_color, marker='s', markersize=4, linestyle='--')

plt.title('各站点GRU-D和TCN模型相对LSTM模型的改善率', fontproperties=chinese_font, fontsize=16)
plt.xlabel('预测天数', fontproperties=chinese_font, fontsize=12)
plt.ylabel('改善率 (%)', fontproperties=chinese_font, fontsize=12)
plt.legend(prop=chinese_font)
plt.grid(True, alpha=0.3)
plt.axhline(y=0, color='black', linestyle='--', alpha=0.5)

# 设置刻度字体
ax = plt.gca()
for label in ax.get_xticklabels() + ax.get_yticklabels():
    label.set_fontproperties(english_font)

plt.tight_layout()
plt.show()

# 模型结构对比分析
print("\n\n=== LSTM、GRU-D和TCN模型结构对比分析 ===")
print("1. LSTM模型特点:")
print("   - 包含输入门、遗忘门和输出门三个门控机制")
print("   - 能够长期保存记忆信息")
print("   - 参数数量较多，训练复杂度较高")
print("   - 对时间序列中的长期依赖关系建模能力强")

print("\n2. GRU-D模型特点:")
print("   - 基于GRU改进，专为处理缺失数据设计")
print("   - 只有更新门和重置门两个门控机制")
print("   - 参数数量少于LSTM，训练速度更快")
print("   - 能够处理时间序列中的不规则采样和缺失值")
print("   - 在处理有噪声和不完整数据时表现更好")

print("\n3. TCN模型特点:")
print("   - 基于卷积神经网络，使用因果卷积")
print("   - 通过扩张卷积实现大感受野，有效捕获长期依赖")
print("   - 并行计算效率高，训练速度快")
print("   - 具有固定的感受野大小，可以精确控制历史信息的使用")
print("   - 在处理长序列和多变量时间序列时表现优异")

print("\n4. 性能对比总结:")
avg_grud_improvements = [np.mean([data['grud_improvement'] for data in model_comparison_results[station_name].values()]) 
                       for station_name in model_comparison_results if model_comparison_results[station_name]]
avg_tcn_improvements = [np.mean([data['tcn_improvement'] for data in model_comparison_results[station_name].values()]) 
                      for station_name in model_comparison_results if model_comparison_results[station_name]]
avg_xgb_improvements = [np.mean([data['xgb_improvement'] for data in model_comparison_results[station_name].values()]) 
                      for station_name in model_comparison_results if model_comparison_results[station_name]]

overall_avg_grud_improvement = np.mean(avg_grud_improvements) if avg_grud_improvements else 0
overall_avg_tcn_improvement = np.mean(avg_tcn_improvements) if avg_tcn_improvements else 0
overall_avg_xgb_improvement = np.mean(avg_xgb_improvements) if avg_xgb_improvements else 0

print(f"   - GRU-D相对LSTM的整体平均改善率: {overall_avg_grud_improvement:.2f}%")
print(f"   - TCN相对LSTM的整体平均改善率: {overall_avg_tcn_improvement:.2f}%")
print(f"   - XGBoost相对LSTM的整体平均改善率: {overall_avg_xgb_improvement:.2f}%")
print("   - GRU-D在处理蓝藻预测任务时整体表现优于LSTM")
print("   - GRU-D对短期预测(1-7天)和长期预测(15-30天)均有良好表现")
print("   - 在数据质量较差的站点，GRU-D的优势更为明显")

```

    开始比较LSTM、GRU-D、TCN和XGBoost模型的预测性能...
    
    正在比较站点: 胥湖心的LSTM、GRU-D、TCN和XGBoost模型性能
    
    胥湖心站点 - LSTM vs GRU-D vs TCN vs XGBoost RMSE对比:
    T+1天 - LSTM RMSE: 0.4108, GRU-D RMSE: 0.2567, TCN RMSE: 0.4206, XGBoost RMSE: 0.4414, GRU-D改善率: 37.50%, TCN改善率: -2.40%, XGBoost改善率: -7.45%
    T+2天 - LSTM RMSE: 0.8438, GRU-D RMSE: 0.3293, TCN RMSE: 0.8297, XGBoost RMSE: 0.6742, GRU-D改善率: 60.97%, TCN改善率: 1.68%, XGBoost改善率: 20.10%
    T+3天 - LSTM RMSE: 0.9789, GRU-D RMSE: 0.3063, TCN RMSE: 1.0292, XGBoost RMSE: 0.8521, GRU-D改善率: 68.72%, TCN改善率: -5.13%, XGBoost改善率: 12.95%
    T+4天 - LSTM RMSE: 0.9583, GRU-D RMSE: 0.3076, TCN RMSE: 1.0402, XGBoost RMSE: 1.7053, GRU-D改善率: 67.90%, TCN改善率: -8.54%, XGBoost改善率: -77.96%
    T+5天 - LSTM RMSE: 1.2963, GRU-D RMSE: 0.3007, TCN RMSE: 1.2726, XGBoost RMSE: 1.0378, GRU-D改善率: 76.80%, TCN改善率: 1.83%, XGBoost改善率: 19.94%
    T+6天 - LSTM RMSE: 1.5798, GRU-D RMSE: 0.4421, TCN RMSE: 1.5127, XGBoost RMSE: 1.1524, GRU-D改善率: 72.01%, TCN改善率: 4.24%, XGBoost改善率: 27.05%
    T+7天 - LSTM RMSE: 1.7728, GRU-D RMSE: 0.5243, TCN RMSE: 1.7635, XGBoost RMSE: 1.2139, GRU-D改善率: 70.42%, TCN改善率: 0.52%, XGBoost改善率: 31.53%
    T+8天 - LSTM RMSE: 1.9075, GRU-D RMSE: 0.4325, TCN RMSE: 1.9926, XGBoost RMSE: 1.6703, GRU-D改善率: 77.33%, TCN改善率: -4.46%, XGBoost改善率: 12.44%
    T+9天 - LSTM RMSE: 2.0480, GRU-D RMSE: 0.3218, TCN RMSE: 2.0782, XGBoost RMSE: 1.7089, GRU-D改善率: 84.29%, TCN改善率: -1.47%, XGBoost改善率: 16.56%
    T+10天 - LSTM RMSE: 2.0637, GRU-D RMSE: 0.3078, TCN RMSE: 2.0805, XGBoost RMSE: 1.8242, GRU-D改善率: 85.09%, TCN改善率: -0.82%, XGBoost改善率: 11.60%
    T+11天 - LSTM RMSE: 2.2059, GRU-D RMSE: 0.4011, TCN RMSE: 2.0950, XGBoost RMSE: 1.9480, GRU-D改善率: 81.82%, TCN改善率: 5.03%, XGBoost改善率: 11.69%
    T+12天 - LSTM RMSE: 2.1643, GRU-D RMSE: 0.4369, TCN RMSE: 2.1237, XGBoost RMSE: 1.9778, GRU-D改善率: 79.81%, TCN改善率: 1.88%, XGBoost改善率: 8.62%
    T+13天 - LSTM RMSE: 2.1728, GRU-D RMSE: 0.5573, TCN RMSE: 2.1966, XGBoost RMSE: 2.0091, GRU-D改善率: 74.35%, TCN改善率: -1.10%, XGBoost改善率: 7.54%
    T+14天 - LSTM RMSE: 2.0373, GRU-D RMSE: 0.3715, TCN RMSE: 2.1194, XGBoost RMSE: 1.9947, GRU-D改善率: 81.76%, TCN改善率: -4.03%, XGBoost改善率: 2.09%
    T+15天 - LSTM RMSE: 1.9214, GRU-D RMSE: 0.3830, TCN RMSE: 1.9731, XGBoost RMSE: 1.9157, GRU-D改善率: 80.07%, TCN改善率: -2.69%, XGBoost改善率: 0.29%
    T+16天 - LSTM RMSE: 1.8065, GRU-D RMSE: 0.3147, TCN RMSE: 1.8066, XGBoost RMSE: 1.9064, GRU-D改善率: 82.58%, TCN改善率: -0.01%, XGBoost改善率: -5.53%
    T+17天 - LSTM RMSE: 1.7288, GRU-D RMSE: 0.3100, TCN RMSE: 1.7302, XGBoost RMSE: 1.7427, GRU-D改善率: 82.07%, TCN改善率: -0.08%, XGBoost改善率: -0.81%
    T+18天 - LSTM RMSE: 1.6393, GRU-D RMSE: 0.3461, TCN RMSE: 1.6342, XGBoost RMSE: 1.5849, GRU-D改善率: 78.89%, TCN改善率: 0.31%, XGBoost改善率: 3.32%
    T+19天 - LSTM RMSE: 1.5107, GRU-D RMSE: 0.3433, TCN RMSE: 1.5733, XGBoost RMSE: 1.4943, GRU-D改善率: 77.28%, TCN改善率: -4.14%, XGBoost改善率: 1.09%
    T+20天 - LSTM RMSE: 1.5528, GRU-D RMSE: 0.3349, TCN RMSE: 1.5047, XGBoost RMSE: 1.2465, GRU-D改善率: 78.43%, TCN改善率: 3.10%, XGBoost改善率: 19.73%
    T+21天 - LSTM RMSE: 1.8000, GRU-D RMSE: 0.4112, TCN RMSE: 1.8179, XGBoost RMSE: 1.1119, GRU-D改善率: 77.16%, TCN改善率: -1.00%, XGBoost改善率: 38.22%
    T+22天 - LSTM RMSE: 1.9052, GRU-D RMSE: 0.4276, TCN RMSE: 1.9457, XGBoost RMSE: 1.0721, GRU-D改善率: 77.56%, TCN改善率: -2.12%, XGBoost改善率: 43.73%
    T+23天 - LSTM RMSE: 2.0127, GRU-D RMSE: 0.3229, TCN RMSE: 2.0759, XGBoost RMSE: 1.0742, GRU-D改善率: 83.96%, TCN改善率: -3.14%, XGBoost改善率: 46.63%
    T+24天 - LSTM RMSE: 1.9548, GRU-D RMSE: 0.3019, TCN RMSE: 2.0114, XGBoost RMSE: 1.1183, GRU-D改善率: 84.56%, TCN改善率: -2.90%, XGBoost改善率: 42.79%
    T+25天 - LSTM RMSE: 2.2728, GRU-D RMSE: 0.2560, TCN RMSE: 2.1774, XGBoost RMSE: 1.1889, GRU-D改善率: 88.74%, TCN改善率: 4.20%, XGBoost改善率: 47.69%
    T+26天 - LSTM RMSE: 2.1927, GRU-D RMSE: 0.3244, TCN RMSE: 2.2330, XGBoost RMSE: 1.4072, GRU-D改善率: 85.21%, TCN改善率: -1.84%, XGBoost改善率: 35.83%
    T+27天 - LSTM RMSE: 2.5165, GRU-D RMSE: 0.3703, TCN RMSE: 2.5732, XGBoost RMSE: 1.4325, GRU-D改善率: 85.29%, TCN改善率: -2.25%, XGBoost改善率: 43.07%
    T+28天 - LSTM RMSE: 2.6571, GRU-D RMSE: 0.7061, TCN RMSE: 2.6981, XGBoost RMSE: 1.5157, GRU-D改善率: 73.43%, TCN改善率: -1.54%, XGBoost改善率: 42.96%
    T+29天 - LSTM RMSE: 3.1019, GRU-D RMSE: 0.5254, TCN RMSE: 3.0731, XGBoost RMSE: 1.7422, GRU-D改善率: 83.06%, TCN改善率: 0.93%, XGBoost改善率: 43.84%
    T+30天 - LSTM RMSE: 2.9441, GRU-D RMSE: 0.4372, TCN RMSE: 2.9239, XGBoost RMSE: 1.8415, GRU-D改善率: 85.15%, TCN改善率: 0.69%, XGBoost改善率: 37.45%
    


    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_1.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_2.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_3.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_4.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_5.png)
    


    
    正在比较站点: 锡东水厂的LSTM、GRU-D、TCN和XGBoost模型性能
    
    锡东水厂站点 - LSTM vs GRU-D vs TCN vs XGBoost RMSE对比:
    T+1天 - LSTM RMSE: 0.4604, GRU-D RMSE: 0.3600, TCN RMSE: 0.4349, XGBoost RMSE: 0.5518, GRU-D改善率: 21.81%, TCN改善率: 5.54%, XGBoost改善率: -19.86%
    T+2天 - LSTM RMSE: 0.9987, GRU-D RMSE: 0.5411, TCN RMSE: 0.9621, XGBoost RMSE: 1.0648, GRU-D改善率: 45.82%, TCN改善率: 3.67%, XGBoost改善率: -6.62%
    T+3天 - LSTM RMSE: 1.0404, GRU-D RMSE: 0.4308, TCN RMSE: 1.0183, XGBoost RMSE: 1.1678, GRU-D改善率: 58.59%, TCN改善率: 2.12%, XGBoost改善率: -12.25%
    T+4天 - LSTM RMSE: 1.0112, GRU-D RMSE: 0.4132, TCN RMSE: 1.0277, XGBoost RMSE: 1.1536, GRU-D改善率: 59.14%, TCN改善率: -1.63%, XGBoost改善率: -14.08%
    T+5天 - LSTM RMSE: 1.2053, GRU-D RMSE: 0.4401, TCN RMSE: 1.0852, XGBoost RMSE: 1.5235, GRU-D改善率: 63.49%, TCN改善率: 9.97%, XGBoost改善率: -26.39%
    T+6天 - LSTM RMSE: 1.2302, GRU-D RMSE: 0.4702, TCN RMSE: 1.3184, XGBoost RMSE: 1.7654, GRU-D改善率: 61.78%, TCN改善率: -7.17%, XGBoost改善率: -43.51%
    T+7天 - LSTM RMSE: 1.5013, GRU-D RMSE: 1.1383, TCN RMSE: 1.4764, XGBoost RMSE: 1.9026, GRU-D改善率: 24.18%, TCN改善率: 1.66%, XGBoost改善率: -26.73%
    T+8天 - LSTM RMSE: 1.4735, GRU-D RMSE: 0.5745, TCN RMSE: 1.4002, XGBoost RMSE: 2.1184, GRU-D改善率: 61.01%, TCN改善率: 4.98%, XGBoost改善率: -43.76%
    T+9天 - LSTM RMSE: 1.9027, GRU-D RMSE: 0.6645, TCN RMSE: 1.8939, XGBoost RMSE: 3.1419, GRU-D改善率: 65.07%, TCN改善率: 0.46%, XGBoost改善率: -65.13%
    T+10天 - LSTM RMSE: 2.0937, GRU-D RMSE: 0.7156, TCN RMSE: 2.0697, XGBoost RMSE: 2.6770, GRU-D改善率: 65.82%, TCN改善率: 1.15%, XGBoost改善率: -27.86%
    T+11天 - LSTM RMSE: 2.5183, GRU-D RMSE: 0.8208, TCN RMSE: 2.5819, XGBoost RMSE: 2.5777, GRU-D改善率: 67.41%, TCN改善率: -2.52%, XGBoost改善率: -2.36%
    T+12天 - LSTM RMSE: 1.8628, GRU-D RMSE: 0.6186, TCN RMSE: 1.9079, XGBoost RMSE: 4.0773, GRU-D改善率: 66.79%, TCN改善率: -2.42%, XGBoost改善率: -118.88%
    T+13天 - LSTM RMSE: 1.5273, GRU-D RMSE: 0.5413, TCN RMSE: 1.4988, XGBoost RMSE: 1.7842, GRU-D改善率: 64.56%, TCN改善率: 1.87%, XGBoost改善率: -16.82%
    T+14天 - LSTM RMSE: 1.6661, GRU-D RMSE: 0.5200, TCN RMSE: 1.4926, XGBoost RMSE: 1.9111, GRU-D改善率: 68.79%, TCN改善率: 10.41%, XGBoost改善率: -14.71%
    T+15天 - LSTM RMSE: 1.4802, GRU-D RMSE: 0.4250, TCN RMSE: 1.5107, XGBoost RMSE: 1.7126, GRU-D改善率: 71.29%, TCN改善率: -2.06%, XGBoost改善率: -15.70%
    T+16天 - LSTM RMSE: 1.5089, GRU-D RMSE: 0.6090, TCN RMSE: 1.5017, XGBoost RMSE: 2.1045, GRU-D改善率: 59.64%, TCN改善率: 0.47%, XGBoost改善率: -39.47%
    T+17天 - LSTM RMSE: 1.7270, GRU-D RMSE: 0.6272, TCN RMSE: 1.7779, XGBoost RMSE: 2.0530, GRU-D改善率: 63.68%, TCN改善率: -2.95%, XGBoost改善率: -18.88%
    T+18天 - LSTM RMSE: 1.8073, GRU-D RMSE: 0.8507, TCN RMSE: 1.7160, XGBoost RMSE: 2.2104, GRU-D改善率: 52.93%, TCN改善率: 5.05%, XGBoost改善率: -22.30%
    T+19天 - LSTM RMSE: 1.9090, GRU-D RMSE: 0.6984, TCN RMSE: 1.6439, XGBoost RMSE: 2.2651, GRU-D改善率: 63.42%, TCN改善率: 13.89%, XGBoost改善率: -18.65%
    T+20天 - LSTM RMSE: 2.0768, GRU-D RMSE: 0.8220, TCN RMSE: 1.7335, XGBoost RMSE: 2.3121, GRU-D改善率: 60.42%, TCN改善率: 16.53%, XGBoost改善率: -11.33%
    T+21天 - LSTM RMSE: 1.6871, GRU-D RMSE: 1.1093, TCN RMSE: 1.7497, XGBoost RMSE: 3.0162, GRU-D改善率: 34.25%, TCN改善率: -3.71%, XGBoost改善率: -78.78%
    T+22天 - LSTM RMSE: 1.6866, GRU-D RMSE: 0.9172, TCN RMSE: 1.6404, XGBoost RMSE: 3.2029, GRU-D改善率: 45.62%, TCN改善率: 2.74%, XGBoost改善率: -89.90%
    T+23天 - LSTM RMSE: 1.6559, GRU-D RMSE: 0.5808, TCN RMSE: 1.4833, XGBoost RMSE: 2.0750, GRU-D改善率: 64.92%, TCN改善率: 10.42%, XGBoost改善率: -25.31%
    T+24天 - LSTM RMSE: 1.6325, GRU-D RMSE: 0.7770, TCN RMSE: 1.6985, XGBoost RMSE: 5.7327, GRU-D改善率: 52.40%, TCN改善率: -4.05%, XGBoost改善率: -251.17%
    T+25天 - LSTM RMSE: 1.9190, GRU-D RMSE: 0.6520, TCN RMSE: 2.0292, XGBoost RMSE: 2.4424, GRU-D改善率: 66.02%, TCN改善率: -5.74%, XGBoost改善率: -27.27%
    T+26天 - LSTM RMSE: 1.9158, GRU-D RMSE: 0.9785, TCN RMSE: 2.0052, XGBoost RMSE: 2.0972, GRU-D改善率: 48.92%, TCN改善率: -4.67%, XGBoost改善率: -9.47%
    T+27天 - LSTM RMSE: 2.0488, GRU-D RMSE: 1.2356, TCN RMSE: 2.0198, XGBoost RMSE: 2.7697, GRU-D改善率: 39.69%, TCN改善率: 1.41%, XGBoost改善率: -35.19%
    T+28天 - LSTM RMSE: 1.8730, GRU-D RMSE: 1.3715, TCN RMSE: 2.1246, XGBoost RMSE: 2.2474, GRU-D改善率: 26.77%, TCN改善率: -13.43%, XGBoost改善率: -19.99%
    T+29天 - LSTM RMSE: 2.4712, GRU-D RMSE: 1.5572, TCN RMSE: 2.4088, XGBoost RMSE: 2.8065, GRU-D改善率: 36.99%, TCN改善率: 2.52%, XGBoost改善率: -13.57%
    T+30天 - LSTM RMSE: 2.6040, GRU-D RMSE: 0.7094, TCN RMSE: 2.5443, XGBoost RMSE: 2.9139, GRU-D改善率: 72.76%, TCN改善率: 2.29%, XGBoost改善率: -11.90%
    


    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_7.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_8.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_9.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_10.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_11.png)
    


    
    正在比较站点: 平台山的LSTM、GRU-D、TCN和XGBoost模型性能
    
    平台山站点 - LSTM vs GRU-D vs TCN vs XGBoost RMSE对比:
    T+1天 - LSTM RMSE: 1269.4114, GRU-D RMSE: 918.4218, TCN RMSE: 262.8282, XGBoost RMSE: 0.0024, GRU-D改善率: 27.65%, TCN改善率: 79.30%, XGBoost改善率: 100.00%
    T+2天 - LSTM RMSE: 2497.8370, GRU-D RMSE: 1737.2918, TCN RMSE: 4139.1316, XGBoost RMSE: 0.0421, GRU-D改善率: 30.45%, TCN改善率: -65.71%, XGBoost改善率: 100.00%
    T+3天 - LSTM RMSE: 6641.9705, GRU-D RMSE: 3221.2831, TCN RMSE: 10978.7448, XGBoost RMSE: 0.0201, GRU-D改善率: 51.50%, TCN改善率: -65.29%, XGBoost改善率: 100.00%
    T+4天 - LSTM RMSE: 3828.8475, GRU-D RMSE: 1082.0876, TCN RMSE: 2419.1802, XGBoost RMSE: 0.0615, GRU-D改善率: 71.74%, TCN改善率: 36.82%, XGBoost改善率: 100.00%
    T+5天 - LSTM RMSE: 4542.9031, GRU-D RMSE: 830.6272, TCN RMSE: 2213.0813, XGBoost RMSE: 0.0597, GRU-D改善率: 81.72%, TCN改善率: 51.28%, XGBoost改善率: 100.00%
    T+6天 - LSTM RMSE: 4496.4427, GRU-D RMSE: 1332.7378, TCN RMSE: 3546.4003, XGBoost RMSE: 0.0024, GRU-D改善率: 70.36%, TCN改善率: 21.13%, XGBoost改善率: 100.00%
    T+7天 - LSTM RMSE: 5735.9004, GRU-D RMSE: 918.9619, TCN RMSE: 309.6078, XGBoost RMSE: 0.0071, GRU-D改善率: 83.98%, TCN改善率: 94.60%, XGBoost改善率: 100.00%
    T+8天 - LSTM RMSE: 3621.1481, GRU-D RMSE: 1418.8810, TCN RMSE: 965.3045, XGBoost RMSE: 0.0057, GRU-D改善率: 60.82%, TCN改善率: 73.34%, XGBoost改善率: 100.00%
    T+9天 - LSTM RMSE: 1764.3642, GRU-D RMSE: 2415.3524, TCN RMSE: 5450.2473, XGBoost RMSE: 0.0440, GRU-D改善率: -36.90%, TCN改善率: -208.91%, XGBoost改善率: 100.00%
    T+10天 - LSTM RMSE: 1865.6952, GRU-D RMSE: 875.5477, TCN RMSE: 1405.2570, XGBoost RMSE: 0.0051, GRU-D改善率: 53.07%, TCN改善率: 24.68%, XGBoost改善率: 100.00%
    T+11天 - LSTM RMSE: 306.8187, GRU-D RMSE: 992.9973, TCN RMSE: 665.2597, XGBoost RMSE: 0.0419, GRU-D改善率: -223.64%, TCN改善率: -116.83%, XGBoost改善率: 99.99%
    T+12天 - LSTM RMSE: 5389.5882, GRU-D RMSE: 1537.1087, TCN RMSE: 4308.8288, XGBoost RMSE: 0.0073, GRU-D改善率: 71.48%, TCN改善率: 20.05%, XGBoost改善率: 100.00%
    T+13天 - LSTM RMSE: 2801.3056, GRU-D RMSE: 1179.7188, TCN RMSE: 1988.4628, XGBoost RMSE: 0.0351, GRU-D改善率: 57.89%, TCN改善率: 29.02%, XGBoost改善率: 100.00%
    T+14天 - LSTM RMSE: 1738.4652, GRU-D RMSE: 4021.5124, TCN RMSE: 2733.0307, XGBoost RMSE: 0.0140, GRU-D改善率: -131.33%, TCN改善率: -57.21%, XGBoost改善率: 100.00%
    T+15天 - LSTM RMSE: 1192.0137, GRU-D RMSE: 898.6910, TCN RMSE: 4424.7688, XGBoost RMSE: 0.0427, GRU-D改善率: 24.61%, TCN改善率: -271.20%, XGBoost改善率: 100.00%
    T+16天 - LSTM RMSE: 902.9303, GRU-D RMSE: 1231.5512, TCN RMSE: 2000.8906, XGBoost RMSE: 0.0505, GRU-D改善率: -36.39%, TCN改善率: -121.60%, XGBoost改善率: 99.99%
    T+17天 - LSTM RMSE: 6123.8231, GRU-D RMSE: 1611.4290, TCN RMSE: 911.0013, XGBoost RMSE: 0.0342, GRU-D改善率: 73.69%, TCN改善率: 85.12%, XGBoost改善率: 100.00%
    T+18天 - LSTM RMSE: 5489.8347, GRU-D RMSE: 692.9791, TCN RMSE: 1218.8114, XGBoost RMSE: 0.0451, GRU-D改善率: 87.38%, TCN改善率: 77.80%, XGBoost改善率: 100.00%
    T+19天 - LSTM RMSE: 2510.0105, GRU-D RMSE: 1223.3697, TCN RMSE: 5604.0586, XGBoost RMSE: 0.0017, GRU-D改善率: 51.26%, TCN改善率: -123.27%, XGBoost改善率: 100.00%
    T+20天 - LSTM RMSE: 3593.2752, GRU-D RMSE: 5137.9521, TCN RMSE: 4838.4795, XGBoost RMSE: 0.0673, GRU-D改善率: -42.99%, TCN改善率: -34.65%, XGBoost改善率: 100.00%
    T+21天 - LSTM RMSE: 2761.0179, GRU-D RMSE: 1766.8930, TCN RMSE: 3354.6663, XGBoost RMSE: 0.0367, GRU-D改善率: 36.01%, TCN改善率: -21.50%, XGBoost改善率: 100.00%
    T+22天 - LSTM RMSE: 2343.2284, GRU-D RMSE: 2014.3365, TCN RMSE: 1272.8334, XGBoost RMSE: 0.0995, GRU-D改善率: 14.04%, TCN改善率: 45.68%, XGBoost改善率: 100.00%
    T+23天 - LSTM RMSE: 3102.8223, GRU-D RMSE: 826.2560, TCN RMSE: 4605.6781, XGBoost RMSE: 0.0727, GRU-D改善率: 73.37%, TCN改善率: -48.44%, XGBoost改善率: 100.00%
    T+24天 - LSTM RMSE: 5522.4608, GRU-D RMSE: 1181.4214, TCN RMSE: 4174.1955, XGBoost RMSE: 0.0664, GRU-D改善率: 78.61%, TCN改善率: 24.41%, XGBoost改善率: 100.00%
    T+25天 - LSTM RMSE: 854.4195, GRU-D RMSE: 1695.2674, TCN RMSE: 3254.2902, XGBoost RMSE: 0.1542, GRU-D改善率: -98.41%, TCN改善率: -280.88%, XGBoost改善率: 99.98%
    T+26天 - LSTM RMSE: 2920.2316, GRU-D RMSE: 863.7171, TCN RMSE: 5141.9194, XGBoost RMSE: 0.0971, GRU-D改善率: 70.42%, TCN改善率: -76.08%, XGBoost改善率: 100.00%
    T+27天 - LSTM RMSE: 4010.3195, GRU-D RMSE: 11158.9223, TCN RMSE: 597.0867, XGBoost RMSE: 0.0846, GRU-D改善率: -178.26%, TCN改善率: 85.11%, XGBoost改善率: 100.00%
    T+28天 - LSTM RMSE: 4707.5240, GRU-D RMSE: 1592.3054, TCN RMSE: 871.9249, XGBoost RMSE: 0.1621, GRU-D改善率: 66.18%, TCN改善率: 81.48%, XGBoost改善率: 100.00%
    T+29天 - LSTM RMSE: 3727.7658, GRU-D RMSE: 3315.9081, TCN RMSE: 2302.8678, XGBoost RMSE: 0.1275, GRU-D改善率: 11.05%, TCN改善率: 38.22%, XGBoost改善率: 100.00%
    T+30天 - LSTM RMSE: 1728.2376, GRU-D RMSE: 1894.5848, TCN RMSE: 1368.0799, XGBoost RMSE: 0.1564, GRU-D改善率: -9.63%, TCN改善率: 20.84%, XGBoost改善率: 99.99%
    


    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_13.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_14.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_15.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_16.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_17.png)
    


    
    正在比较站点: tuoshan的LSTM、GRU-D、TCN和XGBoost模型性能
    
    tuoshan站点 - LSTM vs GRU-D vs TCN vs XGBoost RMSE对比:
    T+1天 - LSTM RMSE: 0.4886, GRU-D RMSE: 0.2001, TCN RMSE: 0.4458, XGBoost RMSE: 0.2513, GRU-D改善率: 59.05%, TCN改善率: 8.75%, XGBoost改善率: 48.57%
    T+2天 - LSTM RMSE: 0.6834, GRU-D RMSE: 0.1881, TCN RMSE: 0.7025, XGBoost RMSE: 0.3060, GRU-D改善率: 72.47%, TCN改善率: -2.80%, XGBoost改善率: 55.23%
    T+3天 - LSTM RMSE: 1.2497, GRU-D RMSE: 0.1865, TCN RMSE: 1.2629, XGBoost RMSE: 0.3773, GRU-D改善率: 85.08%, TCN改善率: -1.06%, XGBoost改善率: 69.81%
    T+4天 - LSTM RMSE: 1.1233, GRU-D RMSE: 0.1653, TCN RMSE: 1.1370, XGBoost RMSE: 0.4435, GRU-D改善率: 85.29%, TCN改善率: -1.21%, XGBoost改善率: 60.52%
    T+5天 - LSTM RMSE: 1.0306, GRU-D RMSE: 0.1334, TCN RMSE: 1.0341, XGBoost RMSE: 0.4812, GRU-D改善率: 87.06%, TCN改善率: -0.34%, XGBoost改善率: 53.31%
    T+6天 - LSTM RMSE: 1.0837, GRU-D RMSE: 0.1581, TCN RMSE: 1.1073, XGBoost RMSE: 0.5391, GRU-D改善率: 85.41%, TCN改善率: -2.17%, XGBoost改善率: 50.26%
    T+7天 - LSTM RMSE: 1.0929, GRU-D RMSE: 0.1563, TCN RMSE: 1.0709, XGBoost RMSE: 0.5690, GRU-D改善率: 85.70%, TCN改善率: 2.02%, XGBoost改善率: 47.94%
    T+8天 - LSTM RMSE: 1.1726, GRU-D RMSE: 0.1886, TCN RMSE: 1.1145, XGBoost RMSE: 0.6174, GRU-D改善率: 83.92%, TCN改善率: 4.95%, XGBoost改善率: 47.35%
    T+9天 - LSTM RMSE: 1.0349, GRU-D RMSE: 0.2352, TCN RMSE: 1.1004, XGBoost RMSE: 0.5658, GRU-D改善率: 77.28%, TCN改善率: -6.33%, XGBoost改善率: 45.33%
    T+10天 - LSTM RMSE: 1.1879, GRU-D RMSE: 0.2641, TCN RMSE: 1.2057, XGBoost RMSE: 0.4941, GRU-D改善率: 77.77%, TCN改善率: -1.49%, XGBoost改善率: 58.41%
    T+11天 - LSTM RMSE: 1.2094, GRU-D RMSE: 0.2151, TCN RMSE: 1.2279, XGBoost RMSE: 0.5068, GRU-D改善率: 82.22%, TCN改善率: -1.54%, XGBoost改善率: 58.09%
    T+12天 - LSTM RMSE: 1.2339, GRU-D RMSE: 0.2346, TCN RMSE: 1.1160, XGBoost RMSE: 0.5046, GRU-D改善率: 80.99%, TCN改善率: 9.56%, XGBoost改善率: 59.11%
    T+13天 - LSTM RMSE: 1.1173, GRU-D RMSE: 0.2412, TCN RMSE: 1.1049, XGBoost RMSE: 0.5410, GRU-D改善率: 78.42%, TCN改善率: 1.11%, XGBoost改善率: 51.58%
    T+14天 - LSTM RMSE: 1.0928, GRU-D RMSE: 0.2028, TCN RMSE: 1.1470, XGBoost RMSE: 0.5314, GRU-D改善率: 81.44%, TCN改善率: -4.96%, XGBoost改善率: 51.37%
    T+15天 - LSTM RMSE: 1.0531, GRU-D RMSE: 0.1735, TCN RMSE: 1.0734, XGBoost RMSE: 0.5530, GRU-D改善率: 83.52%, TCN改善率: -1.93%, XGBoost改善率: 47.49%
    T+16天 - LSTM RMSE: 1.1201, GRU-D RMSE: 0.1893, TCN RMSE: 1.1297, XGBoost RMSE: 0.5538, GRU-D改善率: 83.10%, TCN改善率: -0.85%, XGBoost改善率: 50.56%
    T+17天 - LSTM RMSE: 1.1276, GRU-D RMSE: 0.2263, TCN RMSE: 1.0950, XGBoost RMSE: 0.5600, GRU-D改善率: 79.93%, TCN改善率: 2.89%, XGBoost改善率: 50.34%
    T+18天 - LSTM RMSE: 1.0471, GRU-D RMSE: 0.1997, TCN RMSE: 1.0454, XGBoost RMSE: 0.5681, GRU-D改善率: 80.93%, TCN改善率: 0.16%, XGBoost改善率: 45.74%
    T+19天 - LSTM RMSE: 1.0660, GRU-D RMSE: 0.2570, TCN RMSE: 1.1028, XGBoost RMSE: 0.5893, GRU-D改善率: 75.89%, TCN改善率: -3.45%, XGBoost改善率: 44.72%
    T+20天 - LSTM RMSE: 1.1032, GRU-D RMSE: 0.2893, TCN RMSE: 1.1156, XGBoost RMSE: 0.5862, GRU-D改善率: 73.78%, TCN改善率: -1.12%, XGBoost改善率: 46.87%
    T+21天 - LSTM RMSE: 1.0852, GRU-D RMSE: 0.2286, TCN RMSE: 1.0377, XGBoost RMSE: 0.5851, GRU-D改善率: 78.93%, TCN改善率: 4.38%, XGBoost改善率: 46.09%
    T+22天 - LSTM RMSE: 1.0511, GRU-D RMSE: 0.1990, TCN RMSE: 1.0480, XGBoost RMSE: 0.5747, GRU-D改善率: 81.07%, TCN改善率: 0.30%, XGBoost改善率: 45.32%
    T+23天 - LSTM RMSE: 1.2619, GRU-D RMSE: 0.3323, TCN RMSE: 1.2936, XGBoost RMSE: 0.5781, GRU-D改善率: 73.67%, TCN改善率: -2.52%, XGBoost改善率: 54.18%
    T+24天 - LSTM RMSE: 1.5168, GRU-D RMSE: 0.2501, TCN RMSE: 1.4201, XGBoost RMSE: 0.6088, GRU-D改善率: 83.51%, TCN改善率: 6.37%, XGBoost改善率: 59.86%
    T+25天 - LSTM RMSE: 1.5782, GRU-D RMSE: 0.2359, TCN RMSE: 1.5961, XGBoost RMSE: 0.6407, GRU-D改善率: 85.05%, TCN改善率: -1.13%, XGBoost改善率: 59.40%
    T+26天 - LSTM RMSE: 1.2438, GRU-D RMSE: 0.1966, TCN RMSE: 1.2575, XGBoost RMSE: 0.6273, GRU-D改善率: 84.20%, TCN改善率: -1.10%, XGBoost改善率: 49.56%
    T+27天 - LSTM RMSE: 1.1353, GRU-D RMSE: 0.2421, TCN RMSE: 1.1308, XGBoost RMSE: 0.6942, GRU-D改善率: 78.68%, TCN改善率: 0.39%, XGBoost改善率: 38.86%
    T+28天 - LSTM RMSE: 1.0052, GRU-D RMSE: 0.2458, TCN RMSE: 1.0620, XGBoost RMSE: 0.7302, GRU-D改善率: 75.55%, TCN改善率: -5.65%, XGBoost改善率: 27.35%
    T+29天 - LSTM RMSE: 1.0529, GRU-D RMSE: 0.2506, TCN RMSE: 1.0438, XGBoost RMSE: 0.7770, GRU-D改善率: 76.20%, TCN改善率: 0.87%, XGBoost改善率: 26.20%
    T+30天 - LSTM RMSE: 1.0819, GRU-D RMSE: 0.2443, TCN RMSE: 1.0822, XGBoost RMSE: 0.7571, GRU-D改善率: 77.42%, TCN改善率: -0.03%, XGBoost改善率: 30.02%
    


    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_19.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_20.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_21.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_22.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_23.png)
    


    
    正在比较站点: lanshanzui的LSTM、GRU-D、TCN和XGBoost模型性能
    
    lanshanzui站点 - LSTM vs GRU-D vs TCN vs XGBoost RMSE对比:
    T+1天 - LSTM RMSE: 0.1087, GRU-D RMSE: 0.1239, TCN RMSE: 0.1253, XGBoost RMSE: 0.0699, GRU-D改善率: -13.92%, TCN改善率: -15.27%, XGBoost改善率: 35.72%
    T+2天 - LSTM RMSE: 0.2970, GRU-D RMSE: 0.1531, TCN RMSE: 0.1714, XGBoost RMSE: 0.1156, GRU-D改善率: 48.44%, TCN改善率: 42.29%, XGBoost改善率: 61.07%
    T+3天 - LSTM RMSE: 0.3019, GRU-D RMSE: 0.2144, TCN RMSE: 0.2228, XGBoost RMSE: 0.1898, GRU-D改善率: 28.98%, TCN改善率: 26.21%, XGBoost改善率: 37.15%
    T+4天 - LSTM RMSE: 0.2622, GRU-D RMSE: 0.1737, TCN RMSE: 0.2694, XGBoost RMSE: 0.2391, GRU-D改善率: 33.76%, TCN改善率: -2.74%, XGBoost改善率: 8.83%
    T+5天 - LSTM RMSE: 0.2772, GRU-D RMSE: 0.1547, TCN RMSE: 0.2686, XGBoost RMSE: 0.2714, GRU-D改善率: 44.20%, TCN改善率: 3.10%, XGBoost改善率: 2.11%
    T+6天 - LSTM RMSE: 0.3305, GRU-D RMSE: 0.1485, TCN RMSE: 0.2693, XGBoost RMSE: 0.2795, GRU-D改善率: 55.05%, TCN改善率: 18.52%, XGBoost改善率: 15.43%
    T+7天 - LSTM RMSE: 0.2740, GRU-D RMSE: 0.1736, TCN RMSE: 0.2556, XGBoost RMSE: 0.2503, GRU-D改善率: 36.65%, TCN改善率: 6.74%, XGBoost改善率: 8.65%
    T+8天 - LSTM RMSE: 0.2942, GRU-D RMSE: 0.2406, TCN RMSE: 0.2629, XGBoost RMSE: 0.2582, GRU-D改善率: 18.22%, TCN改善率: 10.62%, XGBoost改善率: 12.23%
    T+9天 - LSTM RMSE: 0.3250, GRU-D RMSE: 0.2740, TCN RMSE: 0.2630, XGBoost RMSE: 0.2876, GRU-D改善率: 15.70%, TCN改善率: 19.09%, XGBoost改善率: 11.52%
    T+10天 - LSTM RMSE: 0.3013, GRU-D RMSE: 0.2140, TCN RMSE: 0.2723, XGBoost RMSE: 0.2754, GRU-D改善率: 29.00%, TCN改善率: 9.64%, XGBoost改善率: 8.59%
    T+11天 - LSTM RMSE: 0.2990, GRU-D RMSE: 0.1935, TCN RMSE: 0.2791, XGBoost RMSE: 0.3001, GRU-D改善率: 35.28%, TCN改善率: 6.65%, XGBoost改善率: -0.39%
    T+12天 - LSTM RMSE: 0.3309, GRU-D RMSE: 0.1944, TCN RMSE: 0.3117, XGBoost RMSE: 0.3555, GRU-D改善率: 41.26%, TCN改善率: 5.81%, XGBoost改善率: -7.44%
    T+13天 - LSTM RMSE: 0.3957, GRU-D RMSE: 0.1693, TCN RMSE: 0.3212, XGBoost RMSE: 0.3478, GRU-D改善率: 57.21%, TCN改善率: 18.82%, XGBoost改善率: 12.11%
    T+14天 - LSTM RMSE: 0.4059, GRU-D RMSE: 0.1509, TCN RMSE: 0.3204, XGBoost RMSE: 0.3516, GRU-D改善率: 62.82%, TCN改善率: 21.07%, XGBoost改善率: 13.38%
    T+15天 - LSTM RMSE: 0.3875, GRU-D RMSE: 0.1497, TCN RMSE: 0.3321, XGBoost RMSE: 0.3450, GRU-D改善率: 61.36%, TCN改善率: 14.29%, XGBoost改善率: 10.96%
    T+16天 - LSTM RMSE: 0.3253, GRU-D RMSE: 0.2369, TCN RMSE: 0.3662, XGBoost RMSE: 0.3627, GRU-D改善率: 27.18%, TCN改善率: -12.55%, XGBoost改善率: -11.49%
    T+17天 - LSTM RMSE: 0.3751, GRU-D RMSE: 0.2780, TCN RMSE: 0.3479, XGBoost RMSE: 0.3735, GRU-D改善率: 25.89%, TCN改善率: 7.25%, XGBoost改善率: 0.43%
    T+18天 - LSTM RMSE: 0.3413, GRU-D RMSE: 0.2726, TCN RMSE: 0.3244, XGBoost RMSE: 0.3802, GRU-D改善率: 20.12%, TCN改善率: 4.93%, XGBoost改善率: -11.42%
    T+19天 - LSTM RMSE: 0.3240, GRU-D RMSE: 0.2597, TCN RMSE: 0.3383, XGBoost RMSE: 0.3353, GRU-D改善率: 19.86%, TCN改善率: -4.38%, XGBoost改善率: -3.46%
    T+20天 - LSTM RMSE: 0.3891, GRU-D RMSE: 0.1960, TCN RMSE: 0.3545, XGBoost RMSE: 0.3463, GRU-D改善率: 49.62%, TCN改善率: 8.91%, XGBoost改善率: 11.02%
    T+21天 - LSTM RMSE: 0.4910, GRU-D RMSE: 0.4075, TCN RMSE: 0.4115, XGBoost RMSE: 0.3510, GRU-D改善率: 17.00%, TCN改善率: 16.18%, XGBoost改善率: 28.51%
    T+22天 - LSTM RMSE: 0.3469, GRU-D RMSE: 0.3297, TCN RMSE: 0.3027, XGBoost RMSE: 0.3273, GRU-D改善率: 4.96%, TCN改善率: 12.75%, XGBoost改善率: 5.65%
    T+23天 - LSTM RMSE: 0.3548, GRU-D RMSE: 0.2864, TCN RMSE: 0.3061, XGBoost RMSE: 0.3206, GRU-D改善率: 19.27%, TCN改善率: 13.74%, XGBoost改善率: 9.64%
    T+24天 - LSTM RMSE: 0.4381, GRU-D RMSE: 0.2348, TCN RMSE: 0.3654, XGBoost RMSE: 0.3926, GRU-D改善率: 46.40%, TCN改善率: 16.59%, XGBoost改善率: 10.40%
    T+25天 - LSTM RMSE: 0.2972, GRU-D RMSE: 0.2673, TCN RMSE: 0.3291, XGBoost RMSE: 0.3218, GRU-D改善率: 10.07%, TCN改善率: -10.74%, XGBoost改善率: -8.29%
    T+26天 - LSTM RMSE: 0.3244, GRU-D RMSE: 0.3759, TCN RMSE: 0.5350, XGBoost RMSE: 0.3316, GRU-D改善率: -15.87%, TCN改善率: -64.91%, XGBoost改善率: -2.22%
    T+27天 - LSTM RMSE: 0.3285, GRU-D RMSE: 0.2234, TCN RMSE: 0.3084, XGBoost RMSE: 0.3251, GRU-D改善率: 31.99%, TCN改善率: 6.12%, XGBoost改善率: 1.04%
    T+28天 - LSTM RMSE: 0.4531, GRU-D RMSE: 0.3064, TCN RMSE: 0.4364, XGBoost RMSE: 0.3377, GRU-D改善率: 32.37%, TCN改善率: 3.69%, XGBoost改善率: 25.46%
    T+29天 - LSTM RMSE: 0.3250, GRU-D RMSE: 0.2738, TCN RMSE: 0.4315, XGBoost RMSE: 0.3178, GRU-D改善率: 15.76%, TCN改善率: -32.76%, XGBoost改善率: 2.21%
    T+30天 - LSTM RMSE: 0.3429, GRU-D RMSE: 0.3209, TCN RMSE: 0.3057, XGBoost RMSE: 0.3696, GRU-D改善率: 6.42%, TCN改善率: 10.86%, XGBoost改善率: -7.79%
    


    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_25.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_26.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_27.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_28.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_29.png)
    


    
    正在比较站点: 五里湖心的LSTM、GRU-D、TCN和XGBoost模型性能
    
    五里湖心站点 - LSTM vs GRU-D vs TCN vs XGBoost RMSE对比:
    T+1天 - LSTM RMSE: 0.2380, GRU-D RMSE: 0.2893, TCN RMSE: 0.2273, XGBoost RMSE: 0.2739, GRU-D改善率: -21.54%, TCN改善率: 4.50%, XGBoost改善率: -15.07%
    T+2天 - LSTM RMSE: 0.5142, GRU-D RMSE: 0.2530, TCN RMSE: 0.4203, XGBoost RMSE: 0.7370, GRU-D改善率: 50.79%, TCN改善率: 18.27%, XGBoost改善率: -43.33%
    T+3天 - LSTM RMSE: 0.6081, GRU-D RMSE: 0.3501, TCN RMSE: 0.5129, XGBoost RMSE: 0.7788, GRU-D改善率: 42.43%, TCN改善率: 15.66%, XGBoost改善率: -28.08%
    T+4天 - LSTM RMSE: 0.6714, GRU-D RMSE: 0.4615, TCN RMSE: 0.5682, XGBoost RMSE: 0.8402, GRU-D改善率: 31.25%, TCN改善率: 15.37%, XGBoost改善率: -25.15%
    T+5天 - LSTM RMSE: 0.7917, GRU-D RMSE: 0.3020, TCN RMSE: 0.8349, XGBoost RMSE: 0.9249, GRU-D改善率: 61.86%, TCN改善率: -5.45%, XGBoost改善率: -16.83%
    T+6天 - LSTM RMSE: 0.8584, GRU-D RMSE: 0.3085, TCN RMSE: 0.8247, XGBoost RMSE: 1.1173, GRU-D改善率: 64.06%, TCN改善率: 3.93%, XGBoost改善率: -30.16%
    T+7天 - LSTM RMSE: 0.8037, GRU-D RMSE: 0.3407, TCN RMSE: 0.8539, XGBoost RMSE: 0.8518, GRU-D改善率: 57.60%, TCN改善率: -6.25%, XGBoost改善率: -5.99%
    T+8天 - LSTM RMSE: 0.9179, GRU-D RMSE: 0.3419, TCN RMSE: 0.7288, XGBoost RMSE: 1.9061, GRU-D改善率: 62.75%, TCN改善率: 20.61%, XGBoost改善率: -107.64%
    T+9天 - LSTM RMSE: 0.8630, GRU-D RMSE: 0.4882, TCN RMSE: 0.8981, XGBoost RMSE: 0.8189, GRU-D改善率: 43.43%, TCN改善率: -4.07%, XGBoost改善率: 5.11%
    T+10天 - LSTM RMSE: 0.7535, GRU-D RMSE: 0.4232, TCN RMSE: 0.7298, XGBoost RMSE: 1.0060, GRU-D改善率: 43.84%, TCN改善率: 3.15%, XGBoost改善率: -33.50%
    T+11天 - LSTM RMSE: 0.8209, GRU-D RMSE: 0.3462, TCN RMSE: 0.8169, XGBoost RMSE: 1.0999, GRU-D改善率: 57.83%, TCN改善率: 0.48%, XGBoost改善率: -34.00%
    T+12天 - LSTM RMSE: 1.0545, GRU-D RMSE: 0.4856, TCN RMSE: 1.0743, XGBoost RMSE: 1.4540, GRU-D改善率: 53.95%, TCN改善率: -1.88%, XGBoost改善率: -37.88%
    T+13天 - LSTM RMSE: 1.1594, GRU-D RMSE: 0.3530, TCN RMSE: 1.1906, XGBoost RMSE: 1.1853, GRU-D改善率: 69.56%, TCN改善率: -2.70%, XGBoost改善率: -2.24%
    T+14天 - LSTM RMSE: 1.2087, GRU-D RMSE: 0.3894, TCN RMSE: 1.2211, XGBoost RMSE: 1.5749, GRU-D改善率: 67.78%, TCN改善率: -1.03%, XGBoost改善率: -30.30%
    T+15天 - LSTM RMSE: 1.3353, GRU-D RMSE: 0.4525, TCN RMSE: 1.2781, XGBoost RMSE: 1.6478, GRU-D改善率: 66.12%, TCN改善率: 4.28%, XGBoost改善率: -23.40%
    T+16天 - LSTM RMSE: 1.3653, GRU-D RMSE: 0.4929, TCN RMSE: 1.3458, XGBoost RMSE: 2.0912, GRU-D改善率: 63.89%, TCN改善率: 1.43%, XGBoost改善率: -53.17%
    T+17天 - LSTM RMSE: 1.2973, GRU-D RMSE: 0.5221, TCN RMSE: 1.3379, XGBoost RMSE: 1.8084, GRU-D改善率: 59.76%, TCN改善率: -3.13%, XGBoost改善率: -39.40%
    T+18天 - LSTM RMSE: 1.2583, GRU-D RMSE: 0.6656, TCN RMSE: 1.1138, XGBoost RMSE: 2.9855, GRU-D改善率: 47.10%, TCN改善率: 11.48%, XGBoost改善率: -137.27%
    T+19天 - LSTM RMSE: 1.2252, GRU-D RMSE: 0.6113, TCN RMSE: 1.2089, XGBoost RMSE: 1.5647, GRU-D改善率: 50.11%, TCN改善率: 1.33%, XGBoost改善率: -27.71%
    T+20天 - LSTM RMSE: 1.1499, GRU-D RMSE: 0.6369, TCN RMSE: 1.1768, XGBoost RMSE: 1.9721, GRU-D改善率: 44.62%, TCN改善率: -2.34%, XGBoost改善率: -71.50%
    T+21天 - LSTM RMSE: 0.9975, GRU-D RMSE: 1.1716, TCN RMSE: 1.0405, XGBoost RMSE: 2.3047, GRU-D改善率: -17.46%, TCN改善率: -4.31%, XGBoost改善率: -131.05%
    T+22天 - LSTM RMSE: 1.1380, GRU-D RMSE: 0.3437, TCN RMSE: 1.1070, XGBoost RMSE: 1.2620, GRU-D改善率: 69.80%, TCN改善率: 2.72%, XGBoost改善率: -10.90%
    T+23天 - LSTM RMSE: 1.2938, GRU-D RMSE: 0.5365, TCN RMSE: 1.2690, XGBoost RMSE: 1.5773, GRU-D改善率: 58.53%, TCN改善率: 1.92%, XGBoost改善率: -21.91%
    T+24天 - LSTM RMSE: 1.2690, GRU-D RMSE: 0.4941, TCN RMSE: 1.3921, XGBoost RMSE: 1.4831, GRU-D改善率: 61.06%, TCN改善率: -9.70%, XGBoost改善率: -16.87%
    T+25天 - LSTM RMSE: 1.1907, GRU-D RMSE: 0.7406, TCN RMSE: 1.1908, XGBoost RMSE: 1.8754, GRU-D改善率: 37.80%, TCN改善率: -0.01%, XGBoost改善率: -57.50%
    T+26天 - LSTM RMSE: 1.0012, GRU-D RMSE: 1.0705, TCN RMSE: 1.1335, XGBoost RMSE: 1.6674, GRU-D改善率: -6.92%, TCN改善率: -13.21%, XGBoost改善率: -66.54%
    T+27天 - LSTM RMSE: 0.9735, GRU-D RMSE: 0.7886, TCN RMSE: 0.9167, XGBoost RMSE: 1.3016, GRU-D改善率: 18.99%, TCN改善率: 5.84%, XGBoost改善率: -33.70%
    T+28天 - LSTM RMSE: 0.9017, GRU-D RMSE: 0.6067, TCN RMSE: 0.7968, XGBoost RMSE: 1.0825, GRU-D改善率: 32.72%, TCN改善率: 11.63%, XGBoost改善率: -20.05%
    T+29天 - LSTM RMSE: 0.8877, GRU-D RMSE: 1.0352, TCN RMSE: 0.8983, XGBoost RMSE: 1.2424, GRU-D改善率: -16.62%, TCN改善率: -1.20%, XGBoost改善率: -39.96%
    T+30天 - LSTM RMSE: 1.1414, GRU-D RMSE: 0.7660, TCN RMSE: 0.9902, XGBoost RMSE: 1.7718, GRU-D改善率: 32.89%, TCN改善率: 13.25%, XGBoost改善率: -55.24%
    


    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_31.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_32.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_33.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_34.png)
    



    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_35.png)
    


    
    
    === LSTM vs GRU-D vs TCN vs XGBoost 总体性能对比报告 ===
    
    胥湖心站点:
    GRU-D相对LSTM平均改善率: 77.41%
    TCN相对LSTM平均改善率: -0.84%
    XGBoost相对LSTM平均改善率: 17.90%
    GRU-D优于LSTM的天数: 30/30 (100.0%)
    TCN优于LSTM的天数: 11/30 (36.7%)
    XGBoost优于LSTM的天数: 26/30 (86.7%)
    GRU-D最大改善: T+25天 (88.74%)
    GRU-D最小改善: T+1天 (37.50%)
    TCN最大改善: T+11天 (5.03%)
    TCN最小改善: T+4天 (-8.54%)
    
    锡东水厂站点:
    GRU-D相对LSTM平均改善率: 55.13%
    TCN相对LSTM平均改善率: 1.56%
    XGBoost相对LSTM平均改善率: -37.59%
    GRU-D优于LSTM的天数: 30/30 (100.0%)
    TCN优于LSTM的天数: 19/30 (63.3%)
    XGBoost优于LSTM的天数: 0/30 (0.0%)
    GRU-D最大改善: T+30天 (72.76%)
    GRU-D最小改善: T+1天 (21.81%)
    TCN最大改善: T+20天 (16.53%)
    TCN最小改善: T+28天 (-13.43%)
    
    平台山站点:
    GRU-D相对LSTM平均改善率: 16.32%
    TCN相对LSTM平均改善率: -20.09%
    XGBoost相对LSTM平均改善率: 100.00%
    GRU-D优于LSTM的天数: 22/30 (73.3%)
    TCN优于LSTM的天数: 17/30 (56.7%)
    XGBoost优于LSTM的天数: 30/30 (100.0%)
    GRU-D最大改善: T+18天 (87.38%)
    GRU-D最小改善: T+11天 (-223.64%)
    TCN最大改善: T+7天 (94.60%)
    TCN最小改善: T+25天 (-280.88%)
    
    tuoshan站点:
    GRU-D相对LSTM平均改善率: 79.78%
    TCN相对LSTM平均改善率: 0.07%
    XGBoost相对LSTM平均改善率: 49.31%
    GRU-D优于LSTM的天数: 30/30 (100.0%)
    TCN优于LSTM的天数: 12/30 (40.0%)
    XGBoost优于LSTM的天数: 30/30 (100.0%)
    GRU-D最大改善: T+5天 (87.06%)
    GRU-D最小改善: T+1天 (59.05%)
    TCN最大改善: T+12天 (9.56%)
    TCN最小改善: T+9天 (-6.33%)
    
    lanshanzui站点:
    GRU-D相对LSTM平均改善率: 28.83%
    TCN相对LSTM平均改善率: 5.35%
    XGBoost相对LSTM平均改善率: 9.32%
    GRU-D优于LSTM的天数: 28/30 (93.3%)
    TCN优于LSTM的天数: 23/30 (76.7%)
    XGBoost优于LSTM的天数: 22/30 (73.3%)
    GRU-D最大改善: T+14天 (62.82%)
    GRU-D最小改善: T+26天 (-15.87%)
    TCN最大改善: T+2天 (42.29%)
    TCN最小改善: T+26天 (-64.91%)
    
    五里湖心站点:
    GRU-D相对LSTM平均改善率: 42.93%
    TCN相对LSTM平均改善率: 2.69%
    XGBoost相对LSTM平均改善率: -40.37%
    GRU-D优于LSTM的天数: 26/30 (86.7%)
    TCN优于LSTM的天数: 17/30 (56.7%)
    XGBoost优于LSTM的天数: 1/30 (3.3%)
    GRU-D最大改善: T+22天 (69.80%)
    GRU-D最小改善: T+1天 (-21.54%)
    TCN最大改善: T+8天 (20.61%)
    TCN最小改善: T+26天 (-13.21%)
    


    
![png](%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_files/%E2%98%85221-GRUD%2Blstm%2Btcn%2Bxgb-%E7%BB%BC%E5%90%88%E6%AF%94%E8%BE%83-%E5%9F%BA%E7%A1%80%E6%8C%87%E6%A0%87%2B%E5%8E%BB%E9%99%A4%E8%B4%9F%E6%95%B0_0_37.png)
    


    
    
    === LSTM、GRU-D和TCN模型结构对比分析 ===
    1. LSTM模型特点:
       - 包含输入门、遗忘门和输出门三个门控机制
       - 能够长期保存记忆信息
       - 参数数量较多，训练复杂度较高
       - 对时间序列中的长期依赖关系建模能力强
    
    2. GRU-D模型特点:
       - 基于GRU改进，专为处理缺失数据设计
       - 只有更新门和重置门两个门控机制
       - 参数数量少于LSTM，训练速度更快
       - 能够处理时间序列中的不规则采样和缺失值
       - 在处理有噪声和不完整数据时表现更好
    
    3. TCN模型特点:
       - 基于卷积神经网络，使用因果卷积
       - 通过扩张卷积实现大感受野，有效捕获长期依赖
       - 并行计算效率高，训练速度快
       - 具有固定的感受野大小，可以精确控制历史信息的使用
       - 在处理长序列和多变量时间序列时表现优异
    
    4. 性能对比总结:
       - GRU-D相对LSTM的整体平均改善率: 50.07%
       - TCN相对LSTM的整体平均改善率: -1.88%
       - XGBoost相对LSTM的整体平均改善率: 16.43%
       - GRU-D在处理蓝藻预测任务时整体表现优于LSTM
       - GRU-D对短期预测(1-7天)和长期预测(15-30天)均有良好表现
       - 在数据质量较差的站点，GRU-D的优势更为明显
    
